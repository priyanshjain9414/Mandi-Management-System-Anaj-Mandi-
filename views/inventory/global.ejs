<% layout("/layouts/boilerplate") %>

<div class="container-fluid px-5 mt-4">
  <!-- ================= HEADER ================= -->
  <div class="card shadow-sm mb-4">
    <div
      class="card-body bg-success-subtle rounded d-flex justify-content-between align-items-center flex-wrap"
    >
      <div class="text-center text-md-start">
        <h4 class="fw-bold text-success mb-1">
          <i class="fa-solid fa-warehouse me-2"> </i>Inventory Dashboard
        </h4>
        <p class="text-muted mb-0">All Crops – Stock, Buy & Sell Summary</p>
      </div>

      <div class="d-flex gap-2">
        <a href="/inventory/list" class="btn btn-outline-success">
          <i class="fa-solid fa-list-check me-1"></i> Crop Details
        </a>
        <a href="javascript:history.back()" class="btn btn-outline-secondary">
          <i class="fa-solid fa-arrow-left me-1"></i> Back
        </a>
      </div>
    </div>
  </div>

  <!-- ================= FILTER ================= -->
  <form class="card shadow-sm mb-4 p-3">
    <div class="row g-3 align-items-end">
      <div class="col-md-4">
        <label class="form-label text-muted">From Date</label>
        <input
          type="date"
          name="from"
          value="<%= from || '' %>"
          class="form-control"
        />
      </div>

      <div class="col-md-4">
        <label class="form-label text-muted">To Date</label>
        <input
          type="date"
          name="to"
          value="<%= to || '' %>"
          class="form-control"
        />
      </div>

      <div class="col-md-4">
        <button class="btn btn-success w-100">
          <i class="fa-solid fa-filter me-1"></i> Apply Filter
        </button>
      </div>
    </div>
  </form>

  <!-- ================= SUMMARY CARDS ================= -->
  <div class="row row-cols-1 row-cols-md-3 g-4 text-center mb-4">
    <!-- TOTAL BUY -->
    <div class="col">
      <div class="card border-success shadow-sm h-100">
        <div class="card-body">
          <h6 class="text-muted">Total Buy Amount</h6>
          <h3 class="fw-bold text-success">
            ₹ <%= totals.buyAmount.toFixed(2) %>
          </h3>

          <hr class="my-2" />

          <p class="mb-0 text-muted">Total Arrival</p>
          <strong><%= totals.totalBuyQuantity %> Qt</strong>
        </div>
      </div>
    </div>

    <!-- TOTAL SELL -->
    <div class="col">
      <div class="card border-primary shadow-sm h-100">
        <div class="card-body">
          <h6 class="text-muted">Total Sell Amount</h6>
          <h3 class="fw-bold text-primary">
            ₹ <%= totals.sellAmount.toFixed(2) %>
          </h3>

          <hr class="my-2" />

          <p class="mb-0 text-muted">Total Sold</p>
          <strong><%= totals.totalSellQuantity %> Qt</strong>
        </div>
      </div>
    </div>

    <!-- CURRENT STOCK -->
    <div class="col">
      <div class="card border-warning shadow-sm h-100">
        <div class="card-body">
          <h6 class="text-muted">Stock Value (Buy)</h6>
          <h3 class="fw-bold text-warning">
            ₹ <%= totals.totalInAmount.toFixed(2) %>
          </h3>

          <hr class="my-2" />

          <p class="mb-0 text-muted">Current Stock</p>
          <strong><%= totals.totalInStock %> Qt</strong>
        </div>
      </div>
    </div>
  </div>
  <hr />
  <!-- ================= PROFIT ================= -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-success text-white">
      <h5 class="mb-0">Total Crop Profit</h5>
    </div>

    <div class="card-body">
      <div class="row text-center g-3">
        <div class="col-md-3">
          <p class="text-muted mb-1">Gross Profit</p>
          <h5 class="fw-bold">₹ <%= totals.grossProfit.toFixed(2) %></h5>
        </div>

        <div class="col-md-3">
          <p class="text-muted mb-1">Labour Charges</p>
          <h5 class="text-danger">₹ <%= totals.labourCharges %></h5>
        </div>

        <div class="col-md-3">
          <p class="text-muted mb-1">Transport Charges</p>
          <h5 class="text-danger">₹ <%= totals.transportCharges %></h5>
        </div>

        <div class="col-md-3">
          <p class="text-muted mb-1">Other Charges</p>
          <h5 class="text-danger">₹ <%= totals.otherCharges %></h5>
        </div>
      </div>

      <hr />

      <div class="text-center">
        <p class="text-muted mb-1">Total Charges</p>
        <h5 class="text-danger fw-bold">₹ <%= totals.totalCharges %></h5>

        <p class="text-muted mt-3 mb-1">Net Profit</p>
        <h2
          class="fw-bold <%= totals.profit >= 0 ? 'text-success' : 'text-danger' %>"
        >
          ₹ <%= totals.profit.toFixed(2) %>
        </h2>
      </div>
    </div>
  </div>
  <hr />
  <!-- ================= PAYMENT SUMMARY ================= -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">Payment Summary</h5>
    </div>

    <div class="card-body">
      <div class="row g-3 text-center">
        <div class="col-md-3">
          <div class="card border-success h-100">
            <div class="card-body">
              <h6 class="text-muted">Paid to Farmers</h6>
              <h5 class="fw-bold text-success">
                ₹ <%= totals.paymentGivePaid %>
              </h5>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card border-danger h-100">
            <div class="card-body">
              <h6 class="text-muted">Pending to Farmers</h6>
              <h5 class="fw-bold text-danger">
                ₹ <%= totals.paymentGivePending %>
              </h5>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card border-primary h-100">
            <div class="card-body">
              <h6 class="text-muted">Received from Buyers</h6>
              <h5 class="fw-bold text-primary">
                ₹ <%= totals.paymentReceivePaid %>
              </h5>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card border-warning h-100">
            <div class="card-body">
              <h6 class="text-muted">Pending from Buyers</h6>
              <h5 class="fw-bold text-warning">
                ₹ <%= totals.paymentReceivePending %>
              </h5>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
