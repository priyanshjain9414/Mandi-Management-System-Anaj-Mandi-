<% layout("/layouts/boilerplate") %>

<div class="container mt-4">
  <!-- PAGE HEADER -->
  <div class="card shadow-sm mb-4">
    <div class="card-body bg-success-subtle rounded text-center">
      <% if(type == "CROP") { %>
      <h4 class="mb-1 text-success fw-bold">
        <i class="fa-solid fa-hourglass-half me-2"></i> Pending Crop Payments
      </h4>
      <p class="text-muted mb-0">
        Farmers with unpaid or partial crop payments
      </p>
      <% } %> <% if(type == "LOAN") { %>
      <h4 class="mb-1 text-success fw-bold">
        <i class="fa-solid fa-hand-holding-dollar me-2"></i> Pending Loan
        Payments
      </h4>
      <p class="text-muted mb-0">
        Farmers with unpaid or partial loan payments
      </p>
      <% } %>
    </div>
  </div>

  <!-- SEARCH BAR -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <form method="GET" action="/farmer/pending">
        <div class="input-group">
          <span
            class="input-group-text bg-success-subtle border-0 text-success"
          >
            <i class="fa-solid fa-magnifying-glass"></i>
          </span>

          <input
            type="text"
            name="search"
            value="<%= search || '' %>"
            class="form-control"
            placeholder="Search by Farmer ID or Name"
          />

          <button class="btn btn-success px-4">Search</button>
        </div>
      </form>
    </div>
  </div>

  <!-- EMPTY STATE -->
  <% if (farmers.length === 0) { %>

  <div class="alert alert-success text-center shadow-sm">
    <i class="fa-solid fa-circle-info me-1"></i>
    <strong>No pending farmers found</strong>
  </div>

  <% } else { %>

  <!-- TABLE -->
  <div class="card shadow-sm">
    <div class="card-header bg-success text-white fw-semibold rounded-top">
      <i class="fa-solid fa-list me-1"></i> Pending Farmers List
    </div>

    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-success">
          <tr>
            <th>Farmer ID</th>
            <th>Name</th>
            <th>Mobile</th>
            <th>Address</th>
            <th class="text-center">Action</th>
          </tr>
        </thead>

        <tbody>
          <% farmers.forEach(farmer => { %>
          <tr>
            <td>
              <span class="badge bg-success rounded-pill px-3 py-2 fs-6">
                <%= farmer.farmerId %>
              </span>
            </td>

            <td><%= farmer.name %></td>

            <td>
              <i class="fa-solid fa-phone text-success me-1"></i>
              <%= farmer.mobile %>
            </td>

            <td class="text-muted">
              <i class="fa-solid fa-location-dot me-1"></i>
              <%= farmer.village %>, <%= farmer.city %>, <%= farmer.state %>
            </td>

            <td class="text-center">
              <a
                href="/farmer/<%= farmer.farmerId %>/fdetail"
                class="btn btn-sm btn-success px-3"
              >
                Details
              </a>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>

  <% } %>
</div>
